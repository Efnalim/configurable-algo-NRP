<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>nsp_solver.simulator.simulator API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>nsp_solver.simulator.simulator</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import copy
from dataclasses import dataclass
import json
import time
from matplotlib import pyplot as plt, ticker
from nsp_solver.simulator.history_simulator import HistorySimulator
from nsp_solver.solver.nsp_solver import NSP_solver
from nsp_solver.utils import utils
from nsp_solver.validator.conf_validator import CONF_EVAL, ConfigValidator
from nsp_solver.validator.validator import ScheduleValidator
import numpy as np


@dataclass
class SimulatorInput():
    &#34;&#34;&#34;Data class serving as an input for the Simulator class.
    It contains:
    the paths to the input files,
    the time limit for computation of 1 week,
    the chosen NSP_solver that will be used for the computation,
    the ScheduleValidator, ConfigValidator, HistorySimulator that will be used during the process of the schedule computation,
    the paths to the output files.
    &#34;&#34;&#34;
    config_file_path: str
    history_file_path: str
    scenario_file_path: str
    week_files_paths: list[str]
    timelimit: int
    solver: NSP_solver
    schedule_validator: ScheduleValidator
    config_validator: ConfigValidator
    historySimulator: HistorySimulator
    graph_output_path: str
    validator_output_path: str


class Simulator:
    &#34;&#34;&#34;Class responsible for the management of the whole process of computation of a schedule.
    &#34;&#34;&#34;
    data: dict = {}

    def simulate_computation(self, input: SimulatorInput):
        &#34;&#34;&#34;Simulate the whole process of computation of a schedule.
        1. Loads the data from the input files.
        2. Evaluates the configuration.
        3. For each week it calls the solver for compuatation of the week and then calls the HistorySimulator to update the history.
        4. Calls the ScheduleValidator to evaluate the computed schedule.

        Args:
            input (SimulatorInput): object containg all inputs

        Returns:
            None: if the process is stopped by the user after the configuration evaluation
            (int, dict): the objective value of the computed schedule and the computed schedule as dictionary.
        &#34;&#34;&#34;
        self._load_data(input)

        if input.config_validator.evaluate_configuration(self.data) is CONF_EVAL.STOP:
            return None

        time_limit_for_week = input.timelimit
        if time_limit_for_week == 0:
            time_limit_for_week = 10 + 10 * (self.data[&#34;num_nurses&#34;] - 20)

        results = self._get_empty_results()

        fail = False
        # accumulate results over weeks
        start = time.time()
        for week_number in range(self.data[&#34;number_weeks&#34;]):
            self.data[&#34;wd_data&#34;] = self.data[&#34;all_wd_data&#34;][week_number]
            input.solver.compute_one_week(time_limit_for_week, self.data, results)
            if results[(week_number, &#34;status&#34;)] == utils.STATUS_FAIL:
                fail = True
                break
            input.historySimulator.update_history_for_next_week(results, self.data)
        end = time.time()
        print(f&#34;time: {end-start}s&#34;)
        if fail:
            total_value = 99999
        else:
            validator = ScheduleValidator()
            # total_value = validator.evaluate_schedule(results, self.data, &#39;outputs/validator_result.txt&#39;)
            total_value = validator.evaluate_schedule(results, self.data, input.validator_output_path)

        if input.graph_output_path is not None:
            self._display_schedule(results, input.graph_output_path)

        return total_value, results

    def _load_data(self, input: SimulatorInput):
        &#34;&#34;&#34;Loads the data from the input files.
        &#34;&#34;&#34;
        with open(input.config_file_path) as config_file:
            config_data = json.load(config_file)

        with open(input.history_file_path) as history_file:
            history_data = json.load(history_file)

        with open(input.scenario_file_path) as scenario_file:
            sc_data = json.load(scenario_file)

        wd_data = []
        for week_file_path in input.week_files_paths:
            with open(week_file_path) as week_file:
                wd_data.append(json.load(week_file))

        # initialize self.data
        number_weeks = len(input.week_files_paths)
        num_nurses = len(sc_data[&#34;nurses&#34;])
        num_shifts = len(sc_data[&#34;shiftTypes&#34;])
        num_skills = len(sc_data[&#34;skills&#34;])
        num_days = 7
        all_nurses = range(num_nurses)
        all_shifts = range(num_shifts)
        all_days = range(num_days)
        all_skills = range(num_skills)
        all_weeks = range(number_weeks)

        self.data[&#34;configuration&#34;] = config_data
        self.data[&#34;h0_data&#34;] = history_data
        self.data[&#34;h0_data_original&#34;] = copy.deepcopy(history_data)
        self.data[&#34;sc_data&#34;] = sc_data
        self.data[&#34;wd_data&#34;] = wd_data[0]
        self.data[&#34;all_wd_data&#34;] = wd_data
        self.data[&#34;number_weeks&#34;] = number_weeks
        self.data[&#34;num_nurses&#34;] = num_nurses
        self.data[&#34;num_shifts&#34;] = num_shifts
        self.data[&#34;num_skills&#34;] = num_skills
        self.data[&#34;num_days&#34;] = num_days
        self.data[&#34;num_weeks&#34;] = number_weeks
        self.data[&#34;all_nurses&#34;] = all_nurses
        self.data[&#34;all_shifts&#34;] = all_shifts
        self.data[&#34;all_days&#34;] = all_days
        self.data[&#34;all_skills&#34;] = all_skills
        self.data[&#34;all_weeks&#34;] = all_weeks

    def _get_empty_results(self) -&gt; dict:
        &#34;&#34;&#34;Return a dictionary for storing the results of compuations of all weeks.

        Returns:
            dict: results with only zeroes.
        &#34;&#34;&#34;
        results = {}
        for w in self.data[&#34;all_weeks&#34;]:
            for n in self.data[&#34;all_nurses&#34;]:
                for d in self.data[&#34;all_days&#34;]:
                    for s in self.data[&#34;all_shifts&#34;]:
                        for sk in self.data[&#34;all_skills&#34;]:
                            results[(n, d + 7 * w, s, sk)] = 0
        return results

    def _display_schedule(self, results, filename):
        &#34;&#34;&#34;
        Saves computed schedule as table in a figure.
        &#34;&#34;&#34;

        num_days = self.data[&#34;num_days&#34;] * self.data[&#34;number_weeks&#34;]
        num_nurses = self.data[&#34;num_nurses&#34;]
        num_skills = self.data[&#34;num_skills&#34;]
        num_shifts = self.data[&#34;num_shifts&#34;]
        num_days_in_week = self.data[&#34;num_days&#34;]

        schedule_table = np.zeros([num_nurses, num_days * num_shifts])
        legend = np.zeros([1, num_skills + 2])

        for d in range(num_days):
            for n in range(num_nurses):
                for s in range(num_shifts):
                    for sk in range(num_skills):
                        if results[(n, d, s, sk)] == 1:
                            schedule_table[n][d * num_shifts + s] = 0.85 - (0.175 * sk)

        if self.data[&#34;configuration&#34;][&#34;h12&#34;]:
            for w in self.data[&#34;all_weeks&#34;]:
                for n in self.data[&#34;all_wd_data&#34;][w][&#34;vacations&#34;]:
                    nurse_id = int(n.split(&#34;_&#34;)[1])
                    for d in range(num_days_in_week):
                        for s in range(num_shifts):
                            schedule_table[nurse_id][(d + 7 * w)*num_shifts + s] = 1

        for sk in range(num_skills):
            legend[0][sk] = 0.85 - (0.175 * sk)
        legend[0][num_skills + 1] = 1

        fig, (ax0, ax1) = plt.subplots(
            2, 1, figsize=(16, 9), gridspec_kw={&#34;height_ratios&#34;: [10, 1]}
        )

        ax0.pcolor(schedule_table)
        ax0.set_title(&#34;Schedule&#34;)
        ax0.set_xticks(np.arange(num_days * num_shifts))
        ax0.set_xticklabels(np.arange(num_days * num_shifts) / 4)
        ax0.tick_params(axis=&#34;x&#34;, bottom=True, top=True, labelbottom=True, labeltop=True)

        ax0.xaxis.set_major_locator(ticker.MultipleLocator(4))

        ax1.pcolor(legend, edgecolors=&#34;k&#34;, linewidths=5)
        ax1.set_title(&#34;Legend - skills&#34;)
        ax1.set_xticks(np.arange(num_skills + 2) + 0.5)
        ax1.set_xticklabels(
            [&#34;HeadNurse&#34;, &#34;Nurse&#34;, &#34;Caretaker&#34;, &#34;Trainee&#34;, &#34;Not working&#34;, &#34;Vacation&#34;]
        )

        fig.tight_layout()
        plt.savefig(filename)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="nsp_solver.simulator.simulator.Simulator"><code class="flex name class">
<span>class <span class="ident">Simulator</span></span>
</code></dt>
<dd>
<div class="desc"><p>Class responsible for the management of the whole process of computation of a schedule.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Simulator:
    &#34;&#34;&#34;Class responsible for the management of the whole process of computation of a schedule.
    &#34;&#34;&#34;
    data: dict = {}

    def simulate_computation(self, input: SimulatorInput):
        &#34;&#34;&#34;Simulate the whole process of computation of a schedule.
        1. Loads the data from the input files.
        2. Evaluates the configuration.
        3. For each week it calls the solver for compuatation of the week and then calls the HistorySimulator to update the history.
        4. Calls the ScheduleValidator to evaluate the computed schedule.

        Args:
            input (SimulatorInput): object containg all inputs

        Returns:
            None: if the process is stopped by the user after the configuration evaluation
            (int, dict): the objective value of the computed schedule and the computed schedule as dictionary.
        &#34;&#34;&#34;
        self._load_data(input)

        if input.config_validator.evaluate_configuration(self.data) is CONF_EVAL.STOP:
            return None

        time_limit_for_week = input.timelimit
        if time_limit_for_week == 0:
            time_limit_for_week = 10 + 10 * (self.data[&#34;num_nurses&#34;] - 20)

        results = self._get_empty_results()

        fail = False
        # accumulate results over weeks
        start = time.time()
        for week_number in range(self.data[&#34;number_weeks&#34;]):
            self.data[&#34;wd_data&#34;] = self.data[&#34;all_wd_data&#34;][week_number]
            input.solver.compute_one_week(time_limit_for_week, self.data, results)
            if results[(week_number, &#34;status&#34;)] == utils.STATUS_FAIL:
                fail = True
                break
            input.historySimulator.update_history_for_next_week(results, self.data)
        end = time.time()
        print(f&#34;time: {end-start}s&#34;)
        if fail:
            total_value = 99999
        else:
            validator = ScheduleValidator()
            # total_value = validator.evaluate_schedule(results, self.data, &#39;outputs/validator_result.txt&#39;)
            total_value = validator.evaluate_schedule(results, self.data, input.validator_output_path)

        if input.graph_output_path is not None:
            self._display_schedule(results, input.graph_output_path)

        return total_value, results

    def _load_data(self, input: SimulatorInput):
        &#34;&#34;&#34;Loads the data from the input files.
        &#34;&#34;&#34;
        with open(input.config_file_path) as config_file:
            config_data = json.load(config_file)

        with open(input.history_file_path) as history_file:
            history_data = json.load(history_file)

        with open(input.scenario_file_path) as scenario_file:
            sc_data = json.load(scenario_file)

        wd_data = []
        for week_file_path in input.week_files_paths:
            with open(week_file_path) as week_file:
                wd_data.append(json.load(week_file))

        # initialize self.data
        number_weeks = len(input.week_files_paths)
        num_nurses = len(sc_data[&#34;nurses&#34;])
        num_shifts = len(sc_data[&#34;shiftTypes&#34;])
        num_skills = len(sc_data[&#34;skills&#34;])
        num_days = 7
        all_nurses = range(num_nurses)
        all_shifts = range(num_shifts)
        all_days = range(num_days)
        all_skills = range(num_skills)
        all_weeks = range(number_weeks)

        self.data[&#34;configuration&#34;] = config_data
        self.data[&#34;h0_data&#34;] = history_data
        self.data[&#34;h0_data_original&#34;] = copy.deepcopy(history_data)
        self.data[&#34;sc_data&#34;] = sc_data
        self.data[&#34;wd_data&#34;] = wd_data[0]
        self.data[&#34;all_wd_data&#34;] = wd_data
        self.data[&#34;number_weeks&#34;] = number_weeks
        self.data[&#34;num_nurses&#34;] = num_nurses
        self.data[&#34;num_shifts&#34;] = num_shifts
        self.data[&#34;num_skills&#34;] = num_skills
        self.data[&#34;num_days&#34;] = num_days
        self.data[&#34;num_weeks&#34;] = number_weeks
        self.data[&#34;all_nurses&#34;] = all_nurses
        self.data[&#34;all_shifts&#34;] = all_shifts
        self.data[&#34;all_days&#34;] = all_days
        self.data[&#34;all_skills&#34;] = all_skills
        self.data[&#34;all_weeks&#34;] = all_weeks

    def _get_empty_results(self) -&gt; dict:
        &#34;&#34;&#34;Return a dictionary for storing the results of compuations of all weeks.

        Returns:
            dict: results with only zeroes.
        &#34;&#34;&#34;
        results = {}
        for w in self.data[&#34;all_weeks&#34;]:
            for n in self.data[&#34;all_nurses&#34;]:
                for d in self.data[&#34;all_days&#34;]:
                    for s in self.data[&#34;all_shifts&#34;]:
                        for sk in self.data[&#34;all_skills&#34;]:
                            results[(n, d + 7 * w, s, sk)] = 0
        return results

    def _display_schedule(self, results, filename):
        &#34;&#34;&#34;
        Saves computed schedule as table in a figure.
        &#34;&#34;&#34;

        num_days = self.data[&#34;num_days&#34;] * self.data[&#34;number_weeks&#34;]
        num_nurses = self.data[&#34;num_nurses&#34;]
        num_skills = self.data[&#34;num_skills&#34;]
        num_shifts = self.data[&#34;num_shifts&#34;]
        num_days_in_week = self.data[&#34;num_days&#34;]

        schedule_table = np.zeros([num_nurses, num_days * num_shifts])
        legend = np.zeros([1, num_skills + 2])

        for d in range(num_days):
            for n in range(num_nurses):
                for s in range(num_shifts):
                    for sk in range(num_skills):
                        if results[(n, d, s, sk)] == 1:
                            schedule_table[n][d * num_shifts + s] = 0.85 - (0.175 * sk)

        if self.data[&#34;configuration&#34;][&#34;h12&#34;]:
            for w in self.data[&#34;all_weeks&#34;]:
                for n in self.data[&#34;all_wd_data&#34;][w][&#34;vacations&#34;]:
                    nurse_id = int(n.split(&#34;_&#34;)[1])
                    for d in range(num_days_in_week):
                        for s in range(num_shifts):
                            schedule_table[nurse_id][(d + 7 * w)*num_shifts + s] = 1

        for sk in range(num_skills):
            legend[0][sk] = 0.85 - (0.175 * sk)
        legend[0][num_skills + 1] = 1

        fig, (ax0, ax1) = plt.subplots(
            2, 1, figsize=(16, 9), gridspec_kw={&#34;height_ratios&#34;: [10, 1]}
        )

        ax0.pcolor(schedule_table)
        ax0.set_title(&#34;Schedule&#34;)
        ax0.set_xticks(np.arange(num_days * num_shifts))
        ax0.set_xticklabels(np.arange(num_days * num_shifts) / 4)
        ax0.tick_params(axis=&#34;x&#34;, bottom=True, top=True, labelbottom=True, labeltop=True)

        ax0.xaxis.set_major_locator(ticker.MultipleLocator(4))

        ax1.pcolor(legend, edgecolors=&#34;k&#34;, linewidths=5)
        ax1.set_title(&#34;Legend - skills&#34;)
        ax1.set_xticks(np.arange(num_skills + 2) + 0.5)
        ax1.set_xticklabels(
            [&#34;HeadNurse&#34;, &#34;Nurse&#34;, &#34;Caretaker&#34;, &#34;Trainee&#34;, &#34;Not working&#34;, &#34;Vacation&#34;]
        )

        fig.tight_layout()
        plt.savefig(filename)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="nsp_solver.simulator.simulator.Simulator.data"><code class="name">var <span class="ident">data</span> : dict</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="nsp_solver.simulator.simulator.Simulator.simulate_computation"><code class="name flex">
<span>def <span class="ident">simulate_computation</span></span>(<span>self, input: <a title="nsp_solver.simulator.simulator.SimulatorInput" href="#nsp_solver.simulator.simulator.SimulatorInput">SimulatorInput</a>)</span>
</code></dt>
<dd>
<div class="desc"><p>Simulate the whole process of computation of a schedule.
1. Loads the data from the input files.
2. Evaluates the configuration.
3. For each week it calls the solver for compuatation of the week and then calls the HistorySimulator to update the history.
4. Calls the ScheduleValidator to evaluate the computed schedule.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code><a title="nsp_solver.simulator.simulator.SimulatorInput" href="#nsp_solver.simulator.simulator.SimulatorInput">SimulatorInput</a></code></dt>
<dd>object containg all inputs</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>None</code></dt>
<dd>if the process is stopped by the user after the configuration evaluation</dd>
</dl>
<p>(int, dict): the objective value of the computed schedule and the computed schedule as dictionary.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def simulate_computation(self, input: SimulatorInput):
    &#34;&#34;&#34;Simulate the whole process of computation of a schedule.
    1. Loads the data from the input files.
    2. Evaluates the configuration.
    3. For each week it calls the solver for compuatation of the week and then calls the HistorySimulator to update the history.
    4. Calls the ScheduleValidator to evaluate the computed schedule.

    Args:
        input (SimulatorInput): object containg all inputs

    Returns:
        None: if the process is stopped by the user after the configuration evaluation
        (int, dict): the objective value of the computed schedule and the computed schedule as dictionary.
    &#34;&#34;&#34;
    self._load_data(input)

    if input.config_validator.evaluate_configuration(self.data) is CONF_EVAL.STOP:
        return None

    time_limit_for_week = input.timelimit
    if time_limit_for_week == 0:
        time_limit_for_week = 10 + 10 * (self.data[&#34;num_nurses&#34;] - 20)

    results = self._get_empty_results()

    fail = False
    # accumulate results over weeks
    start = time.time()
    for week_number in range(self.data[&#34;number_weeks&#34;]):
        self.data[&#34;wd_data&#34;] = self.data[&#34;all_wd_data&#34;][week_number]
        input.solver.compute_one_week(time_limit_for_week, self.data, results)
        if results[(week_number, &#34;status&#34;)] == utils.STATUS_FAIL:
            fail = True
            break
        input.historySimulator.update_history_for_next_week(results, self.data)
    end = time.time()
    print(f&#34;time: {end-start}s&#34;)
    if fail:
        total_value = 99999
    else:
        validator = ScheduleValidator()
        # total_value = validator.evaluate_schedule(results, self.data, &#39;outputs/validator_result.txt&#39;)
        total_value = validator.evaluate_schedule(results, self.data, input.validator_output_path)

    if input.graph_output_path is not None:
        self._display_schedule(results, input.graph_output_path)

    return total_value, results</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput"><code class="flex name class">
<span>class <span class="ident">SimulatorInput</span></span>
<span>(</span><span>config_file_path: str, history_file_path: str, scenario_file_path: str, week_files_paths: list, timelimit: int, solver: <a title="nsp_solver.solver.nsp_solver.NSP_solver" href="../solver/nsp_solver.html#nsp_solver.solver.nsp_solver.NSP_solver">NSP_solver</a>, schedule_validator: <a title="nsp_solver.validator.validator.ScheduleValidator" href="../validator/validator.html#nsp_solver.validator.validator.ScheduleValidator">ScheduleValidator</a>, config_validator: <a title="nsp_solver.validator.conf_validator.ConfigValidator" href="../validator/conf_validator.html#nsp_solver.validator.conf_validator.ConfigValidator">ConfigValidator</a>, historySimulator: <a title="nsp_solver.simulator.history_simulator.HistorySimulator" href="history_simulator.html#nsp_solver.simulator.history_simulator.HistorySimulator">HistorySimulator</a>, graph_output_path: str, validator_output_path: str)</span>
</code></dt>
<dd>
<div class="desc"><p>Data class serving as an input for the Simulator class.
It contains:
the paths to the input files,
the time limit for computation of 1 week,
the chosen NSP_solver that will be used for the computation,
the ScheduleValidator, ConfigValidator, HistorySimulator that will be used during the process of the schedule computation,
the paths to the output files.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class SimulatorInput():
    &#34;&#34;&#34;Data class serving as an input for the Simulator class.
    It contains:
    the paths to the input files,
    the time limit for computation of 1 week,
    the chosen NSP_solver that will be used for the computation,
    the ScheduleValidator, ConfigValidator, HistorySimulator that will be used during the process of the schedule computation,
    the paths to the output files.
    &#34;&#34;&#34;
    config_file_path: str
    history_file_path: str
    scenario_file_path: str
    week_files_paths: list[str]
    timelimit: int
    solver: NSP_solver
    schedule_validator: ScheduleValidator
    config_validator: ConfigValidator
    historySimulator: HistorySimulator
    graph_output_path: str
    validator_output_path: str</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.config_file_path"><code class="name">var <span class="ident">config_file_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.config_validator"><code class="name">var <span class="ident">config_validator</span> : <a title="nsp_solver.validator.conf_validator.ConfigValidator" href="../validator/conf_validator.html#nsp_solver.validator.conf_validator.ConfigValidator">ConfigValidator</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.graph_output_path"><code class="name">var <span class="ident">graph_output_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.historySimulator"><code class="name">var <span class="ident">historySimulator</span> : <a title="nsp_solver.simulator.history_simulator.HistorySimulator" href="history_simulator.html#nsp_solver.simulator.history_simulator.HistorySimulator">HistorySimulator</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.history_file_path"><code class="name">var <span class="ident">history_file_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.scenario_file_path"><code class="name">var <span class="ident">scenario_file_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.schedule_validator"><code class="name">var <span class="ident">schedule_validator</span> : <a title="nsp_solver.validator.validator.ScheduleValidator" href="../validator/validator.html#nsp_solver.validator.validator.ScheduleValidator">ScheduleValidator</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.solver"><code class="name">var <span class="ident">solver</span> : <a title="nsp_solver.solver.nsp_solver.NSP_solver" href="../solver/nsp_solver.html#nsp_solver.solver.nsp_solver.NSP_solver">NSP_solver</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.timelimit"><code class="name">var <span class="ident">timelimit</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.validator_output_path"><code class="name">var <span class="ident">validator_output_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="nsp_solver.simulator.simulator.SimulatorInput.week_files_paths"><code class="name">var <span class="ident">week_files_paths</span> : list</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="nsp_solver.simulator" href="index.html">nsp_solver.simulator</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="nsp_solver.simulator.simulator.Simulator" href="#nsp_solver.simulator.simulator.Simulator">Simulator</a></code></h4>
<ul class="">
<li><code><a title="nsp_solver.simulator.simulator.Simulator.data" href="#nsp_solver.simulator.simulator.Simulator.data">data</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.Simulator.simulate_computation" href="#nsp_solver.simulator.simulator.Simulator.simulate_computation">simulate_computation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="nsp_solver.simulator.simulator.SimulatorInput" href="#nsp_solver.simulator.simulator.SimulatorInput">SimulatorInput</a></code></h4>
<ul class="">
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.config_file_path" href="#nsp_solver.simulator.simulator.SimulatorInput.config_file_path">config_file_path</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.config_validator" href="#nsp_solver.simulator.simulator.SimulatorInput.config_validator">config_validator</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.graph_output_path" href="#nsp_solver.simulator.simulator.SimulatorInput.graph_output_path">graph_output_path</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.historySimulator" href="#nsp_solver.simulator.simulator.SimulatorInput.historySimulator">historySimulator</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.history_file_path" href="#nsp_solver.simulator.simulator.SimulatorInput.history_file_path">history_file_path</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.scenario_file_path" href="#nsp_solver.simulator.simulator.SimulatorInput.scenario_file_path">scenario_file_path</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.schedule_validator" href="#nsp_solver.simulator.simulator.SimulatorInput.schedule_validator">schedule_validator</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.solver" href="#nsp_solver.simulator.simulator.SimulatorInput.solver">solver</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.timelimit" href="#nsp_solver.simulator.simulator.SimulatorInput.timelimit">timelimit</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.validator_output_path" href="#nsp_solver.simulator.simulator.SimulatorInput.validator_output_path">validator_output_path</a></code></li>
<li><code><a title="nsp_solver.simulator.simulator.SimulatorInput.week_files_paths" href="#nsp_solver.simulator.simulator.SimulatorInput.week_files_paths">week_files_paths</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>